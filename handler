import datetime


def handle_msg(self, sclient, msg, client_info):
    client_info["last_message_time"] = datetime.now()

    self._notify_ui()

    self.broadcast(
        f"MSG|{client_info['pseudo']}|{msg.args[0]}",
        room=client_info["room"],
        sender_socket=sclient
    )

    return False  # ne quitte pas la boucle


def handle_room(self, sclient, msg, client_info):
    old_room = client_info["room"]
    new_room = msg.args[0]

    client_info["room"] = new_room

    self._notify_ui()

    if old_room:
        self.broadcast(
            f"SYSTEM|{client_info['pseudo']} a quitt√© la room {old_room}",
            room=old_room
        )

    self.broadcast(
        f"SYSTEM|{client_info['pseudo']} a rejoint la room {new_room}",
        room=new_room
    )

    return False


def handle_quit(self, sclient, msg, client_info):
    return True
